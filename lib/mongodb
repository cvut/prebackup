#!/usr/local/bin/prebackup
# vim: set ft=sh ts=4:
#
# Variables:
#   mongo_user     : Username for authentication (optional).
#   mongo_password : Password for authentication (optional).

pre-backup() {
	local opts=
	if [ -n "$mongo_user" ]; then
		opts="--username=$mongo_user --password=$mongo_password --authenticationDatabase=admin"
	fi
	mongodump $opts --quiet --out="$target_dir"
}

post-backup() {
	if [ ! -d "$target_dir" ]; then
		fail "$target_dir does not exist or not a directory!"
	fi
	rm -Rf "$target_dir"/*
}
